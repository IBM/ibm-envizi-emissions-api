<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Carbon-aware fleet vehicle selection for crews" href="../sustainable_crew_scheduling/carbon_aware_crew_scheduling.html" /><link rel="prev" title="Calculating the Environmental Impact of Power Plants" href="../environmental_impact_of_power_plant/power_plant.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Getting Insights About Refrigeration Leaks - IBM Envizi - Emissions API documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=8d04aa46" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">IBM Envizi - Emissions API  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">IBM Envizi - Emissions API  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introducing IBM Envizi - Emissions API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../../samples/index.html">Samples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Samples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../../../samples/scope1/index.html">Scope 1</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Scope 1</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../environmental_impact_of_power_plant/power_plant.html">Calculating the Environmental Impact of Power Plants</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Getting Insights About Refrigeration Leaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sustainable_crew_scheduling/carbon_aware_crew_scheduling.html">Carbon-aware fleet vehicle selection for crews</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/general/index.html">General</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of General</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/general/calculation.html">Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/general/factor.html">Factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/general/search.html">Search</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/scope1/index.html">Scope 1</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Scope 1</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/scope1/fugitive_emission.html">Fugitive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/scope1/mobile_emission.html">Mobile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/scope1/stationary_emission.html">Stationary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/scope2/index.html">Scope 2</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Scope 2</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/scope2/location_based_emission.html">Location</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/scope3/index.html">Scope 3</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Scope 3</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/scope3/transportation_and_distribution_emission.html">Transportation and Distribution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/notebooks/samples/scope1/refrigeration_leaks_insights/refrigeration_leaks_insights.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Getting-Insights-About-Refrigeration-Leaks">
<h1>Getting Insights About Refrigeration Leaks<a class="headerlink" href="#Getting-Insights-About-Refrigeration-Leaks" title="Link to this heading">¶</a></h1>
<p><strong>Table of contents</strong></p>
<ul class="simple">
<li><p>Overview</p></li>
<li><p>Setup</p>
<ul>
<li><p>Authorization Token</p></li>
</ul>
</li>
<li><p>Utility Functions</p></li>
<li><p>Use Case Implementation</p>
<ul>
<li><p>Querying for the refrigeration use case</p></li>
<li><p>Exploratory Data Analysis</p></li>
</ul>
</li>
<li><p>Related Links</p></li>
</ul>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading">¶</a></h2>
<p>The <strong>IBM Envizi - Emissions API, Fugitive Emissions API</strong> is used in this sample application.</p>
<p>The notebook illustrates how to calculate fugitive emissions and perform a downstream analysis of fugitive emissions for organizations that operate large-scale and geographically-diverse refrigeration assets. These types of assets are fairly common in the food processing industry. The API requires the type of refrigerant and its consumption.</p>
<p><strong>Business value</strong></p>
<p>By leveraging these calculations, organizations can make data-driven decisions about refrigeration assets and their corresponding environmental impact.</p>
<p><strong>Use Case</strong></p>
<p>In this notebook, an example dataset of refrigeration assets will be used to demonstrate how the fugitive emissions API can get useful insights for an organization.</p>
</section>
<section id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Link to this heading">¶</a></h2>
<p>Ensure that Python 3+ is installed on your system.</p>
<p>Note: To run this notebook, you must first add your credentials to <code class="docutils literal notranslate"><span class="pre">'../../../auth/secrets.ini'</span></code> in the following format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[EAPI]
api.api_key = &lt;Your Emissions API Key&gt;
api.tenant_id = &lt;Your Emissions API Tenant Id&gt;
api.org_id = &lt;Your Emissions API Org Id&gt;
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install the prerequisite Python packages</span>
<span class="o">%</span><span class="k">pip</span> install pandas configparser IPython geopy tqdm openpyxl matplotlib pycountry
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">geopy.geocoders</span> <span class="kn">import</span> <span class="n">Nominatim</span>
<span class="kn">import</span> <span class="nn">pycountry</span>
</pre></div>
</div>
</div>
<section id="Authorization-Token">
<h3>Authorization Token<a class="headerlink" href="#Authorization-Token" title="Link to this heading">¶</a></h3>
<p>Run the following code snippet to generate a Bearer Token by using your api_key configured in secrets.ini.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">RawConfigParser</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="s1">&#39;../../../auth/secrets.ini&#39;</span><span class="p">,</span><span class="s1">&#39;../../../auth/config.ini&#39;</span><span class="p">])</span>

<span class="n">EAPI_API_KEY</span>        <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EAPI&#39;</span><span class="p">,</span> <span class="s1">&#39;api.api_key&#39;</span><span class="p">)</span>
<span class="n">EAPI_TENANT_ID</span>      <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EAPI&#39;</span><span class="p">,</span> <span class="s1">&#39;api.tenant_id&#39;</span><span class="p">)</span>
<span class="n">EAPI_CLIENT_ID</span>      <span class="o">=</span> <span class="s1">&#39;ghgemissions-&#39;</span> <span class="o">+</span> <span class="n">EAPI_TENANT_ID</span>
<span class="n">EAPI_ORG_ID</span>         <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EAPI&#39;</span><span class="p">,</span> <span class="s1">&#39;api.org_id&#39;</span><span class="p">)</span>

<span class="n">EAPI_AUTH_CLIENT_ID</span> <span class="o">=</span> <span class="s1">&#39;saascore-&#39;</span> <span class="o">+</span> <span class="n">EAPI_TENANT_ID</span>
<span class="n">EAPI_AUTH_ENDPOINT</span>  <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EAPI&#39;</span><span class="p">,</span> <span class="s1">&#39;api.auth_endpoint&#39;</span><span class="p">)</span>

<span class="n">EAPI_BASE_URL</span>       <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EAPI&#39;</span><span class="p">,</span> <span class="s1">&#39;api.base_url&#39;</span><span class="p">)</span>
<span class="n">EAPI_ENDPOINT</span>       <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EAPI_BASE_URL</span><span class="si">}</span><span class="s2">/fugitive&quot;</span>

<span class="n">auth_request_headers</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">auth_request_headers</span><span class="p">[</span><span class="s2">&quot;X-IBM-Client-Id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EAPI_AUTH_CLIENT_ID</span>
<span class="n">auth_request_headers</span><span class="p">[</span><span class="s2">&quot;X-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EAPI_API_KEY</span>

<span class="n">verify</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">auth_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EAPI_AUTH_ENDPOINT</span><span class="si">}</span><span class="s2">/api-key?orgId=</span><span class="si">{</span><span class="n">EAPI_ORG_ID</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="n">auth_url</span><span class="p">,</span>
                        <span class="n">headers</span> <span class="o">=</span> <span class="n">auth_request_headers</span><span class="p">,</span>
                        <span class="n">verify</span>  <span class="o">=</span> <span class="n">verify</span>
                       <span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">jwt_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authentication Success&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Authentication Failed&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Authentication Success
</pre></div></div>
</div>
</section>
</section>
<section id="Utility-Functions">
<h2>Utility Functions<a class="headerlink" href="#Utility-Functions" title="Link to this heading">¶</a></h2>
<p>The following utility functions will be defined to help load, format, and submit data to the Fugitive Emissions API:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">read_excel_file</span></code>: Reads the input Excel file and performs data formatting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geo_coder</span></code>: Converts geolocation to address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">create_payload</span></code>: Converts dict or dataframe-row to json format expected by the API</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_fugitive_emission_from_api</span></code>: Queries the API with a given payload and returns the CO2e</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_excel_file</span><span class="p">(</span><span class="n">excel_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads the input excel file and performs data formatting</span>
<span class="sd">    args:</span>
<span class="sd">        excel_path: Path to the input spreadsheet file or a file like object</span>
<span class="sd">        sheet_name: Sheet name to be read if there are multiple sheets</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Read the excel file</span>
    <span class="k">if</span> <span class="n">sheet_name</span><span class="p">:</span>
        <span class="n">data_orig_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">excel_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_orig_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">excel_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span>


    <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1">## process columns which require flatenning</span>
    <span class="n">column_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;organisation&#39;</span>          <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Organisation&#39;</span>          <span class="p">]</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;geo_coordinates&#39;</span>       <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Geo-coordinates&#39;</span>       <span class="p">]</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;static_parameters&#39;</span>     <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Static parameters&#39;</span>     <span class="p">]</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;operational_parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Operational parameters&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span>             <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span>             <span class="p">]</span><span class="o">.</span><span class="n">columns</span>

    <span class="n">data_df</span><span class="p">[</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;organisation&#39;</span>          <span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Organisation&#39;</span>          <span class="p">][</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;organisation&#39;</span>          <span class="p">]]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;geo_coordinates&#39;</span>       <span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Geo-coordinates&#39;</span>       <span class="p">][</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;geo_coordinates&#39;</span>       <span class="p">]]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;static_parameters&#39;</span>     <span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Static parameters&#39;</span>     <span class="p">][</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;static_parameters&#39;</span>     <span class="p">]]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;operational_parameters&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Operational parameters&#39;</span><span class="p">][</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;operational_parameters&#39;</span><span class="p">]]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span>             <span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span>             <span class="p">][</span><span class="n">column_dict</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span>             <span class="p">]]</span>

    <span class="c1">## Process/copy remaining columns that do not require flattening</span>
    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Asset id&#39;</span>            <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Asset id&#39;</span>            <span class="p">]</span> <span class="c1">## Keeping the asset id column name same</span>
    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;asset_type&#39;</span>          <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Asset type&#39;</span>          <span class="p">]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span>                <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Commodity type&#39;</span>      <span class="p">]</span>
<span class="c1">#     data_df[&#39;commodity_usage&#39;     ] = data_orig_df[&#39;Commodity Usage&#39;     ]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Consumption Quantity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Consumption Quantity&#39;</span><span class="p">]</span>
    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Unit&#39;</span>                <span class="p">]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[</span><span class="s1">&#39;Consumption unit&#39;</span>    <span class="p">]</span>

    <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Asset id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;Asset id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Emission&#39;</span> <span class="ow">in</span> <span class="n">data_orig_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">data_df</span><span class="p">[[</span><span class="s1">&#39;emission&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data_orig_df</span><span class="p">[[</span><span class="s1">&#39;Emission&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">return</span> <span class="n">data_df</span>

<span class="c1">#reading refrigeration data(location,type etc)</span>
<span class="n">read_excel_file</span><span class="p">(</span><span class="s1">&#39;./refrigeration_leaks_insights.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Level 0</th>
      <th>Level 1</th>
      <th>Level 2</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Cap</th>
      <th>GWP</th>
      <th>Age</th>
      <th>leak%</th>
      <th>Start Date (YYYY-MM-DD)</th>
      <th>End Date (YYYY-MM-DD)</th>
      <th>Asset id</th>
      <th>asset_type</th>
      <th>Type</th>
      <th>Consumption Quantity</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>name1</td>
      <td>FOOD STORAGE</td>
      <td>USA</td>
      <td>42.93</td>
      <td>-93.48</td>
      <td>3900</td>
      <td>1.273</td>
      <td>19</td>
      <td>25.25</td>
      <td>2024-04-11</td>
      <td>2025-04-11</td>
      <td>14201</td>
      <td>Refrigeration</td>
      <td>R-448A</td>
      <td>897.6</td>
      <td>kg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>name1</td>
      <td>FOOD STORAGE</td>
      <td>USA</td>
      <td>33.87</td>
      <td>-95.23</td>
      <td>3600</td>
      <td>0.573</td>
      <td>5</td>
      <td>14.18</td>
      <td>2024-04-12</td>
      <td>2025-04-12</td>
      <td>14202</td>
      <td>Refrigeration</td>
      <td>R-513A</td>
      <td>502.2</td>
      <td>kg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>name1</td>
      <td>FOOD STORAGE</td>
      <td>USA</td>
      <td>48.34</td>
      <td>-95.43</td>
      <td>3800</td>
      <td>2.235</td>
      <td>15</td>
      <td>22.81</td>
      <td>2024-04-13</td>
      <td>2025-04-13</td>
      <td>14203</td>
      <td>Refrigeration</td>
      <td>R-507A</td>
      <td>825.1</td>
      <td>kg</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">geo_coder</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts geolocation to address</span>
<span class="sd">    args:</span>
<span class="sd">        lat: lattitue of the location</span>
<span class="sd">        long: longitute og the location</span>

<span class="sd">    returns:</span>
<span class="sd">        country, state, city, zipcode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s2">&quot;geolocation_identifier_function&quot;</span><span class="p">)</span>
    <span class="n">location</span>   <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;,&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">long</span><span class="p">),</span><span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">address</span>    <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;address&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">address</span><span class="o">=</span><span class="p">{}</span>
        <span class="nb">print</span><span class="p">((</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">))</span>

    <span class="n">country</span>  <span class="o">=</span> <span class="n">address</span><span class="p">[</span><span class="s1">&#39;country&#39;</span> <span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;country&#39;</span>  <span class="ow">in</span> <span class="n">address</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">country</span>  <span class="o">=</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">country</span><span class="p">)</span><span class="o">.</span><span class="n">alpha_3</span>
    <span class="n">state</span>    <span class="o">=</span> <span class="n">address</span><span class="p">[</span><span class="s1">&#39;state&#39;</span>   <span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;state&#39;</span>    <span class="ow">in</span> <span class="n">address</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">city</span>     <span class="o">=</span> <span class="n">address</span><span class="p">[</span><span class="s1">&#39;city&#39;</span>    <span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;city&#39;</span>     <span class="ow">in</span> <span class="n">address</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="s1">&#39;postcode&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">address</span><span class="p">:</span> <span class="n">zipcode</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zipcode</span> <span class="o">=</span> <span class="n">address</span><span class="p">[</span><span class="s2">&quot;postcode&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># use only first part of zipcode</span>
        <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">zipcode</span><span class="p">:</span> <span class="n">zipcode</span> <span class="o">=</span> <span class="n">zipcode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># ignore the state code and use the last part of zipcode</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">zipcode</span><span class="p">:</span> <span class="n">zipcode</span> <span class="o">=</span> <span class="n">zipcode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># use only first part of zipcode</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">country</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">zipcode</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_payload</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts dict or a row of dataframe to json format accepted by the API</span>
<span class="sd">    args:</span>
<span class="sd">        data: python dict or dataframe row</span>
<span class="sd">    returns:</span>
<span class="sd">        payload: json format accepted by the API</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Convert lat-long to address for payload[&quot;location&quot;]</span>
    <span class="n">country</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">zipcode</span> <span class="o">=</span> <span class="n">geo_coder</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Lat&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Long&quot;</span><span class="p">])</span>

    <span class="c1">## create the JSON</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;activity&quot;</span>    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span>  <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">],</span>
                               <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Cap&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Consumption Quantity&quot;</span><span class="p">],</span>
                               <span class="s2">&quot;unit&quot;</span><span class="p">:</span>  <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span>
                              <span class="p">}</span>
    <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;location&quot;</span>        <span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="n">country</span><span class="p">,</span> <span class="s2">&quot;stateProvince&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">}</span>
    <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;time&quot;</span>            <span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Start Date (YYYY-MM-DD)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">())}</span>

    <span class="k">return</span> <span class="n">payload</span>

<span class="c1">#display(create_payload(read_excel_file(&#39;./refrigeration_leaks_insights.xlsx&#39;, &#39;Sheet1&#39;).head(100).iloc[99]))</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_fugitive_emission_from_api</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Queries the fugitive emission APIs and returns the CO2e emissions</span>
<span class="sd">    args:</span>
<span class="sd">        payload: Payload for which CO2 is required</span>
<span class="sd">    returns:</span>
<span class="sd">        CO2 emissions for the payload</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create the query headers</span>
    <span class="n">request_headers</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">request_headers</span><span class="p">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span>
    <span class="n">request_headers</span><span class="p">[</span><span class="s2">&quot;x-ibm-client-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EAPI_CLIENT_ID</span>
    <span class="n">request_headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bearer &quot;</span> <span class="o">+</span> <span class="n">jwt_token</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">EAPI_ENDPOINT</span><span class="p">,</span>
                                 <span class="n">headers</span> <span class="o">=</span> <span class="n">request_headers</span><span class="p">,</span>
                                 <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
        <span class="n">emissions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">emissions</span><span class="p">[</span><span class="s1">&#39;totalCO2e&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;API call failed with &#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1">## Return NaN if call fails</span>
<br/></pre></div>
</div>
</div>
<p>To see the expected values of the individual fields of the request payload, please see <a class="reference external" href="https://developer.ibm.com/apis/catalog/ghgemissions--ibm-envizi-emissions-api/Introduction">Emissions API Developer Guide</a>.</p>
</section>
<section id="Use-Case-Implementation">
<h2>Use Case Implementation<a class="headerlink" href="#Use-Case-Implementation" title="Link to this heading">¶</a></h2>
<section id="Querying-for-the-refrigeration-use-case">
<h3>Querying for the refrigeration use case<a class="headerlink" href="#Querying-for-the-refrigeration-use-case" title="Link to this heading">¶</a></h3>
<p>In this section, the fugitive emissions are calculated using the <strong>Fugitive Emissions API</strong> for all the data, that is, rows in the spreadsheet. The following actions are performed: - The spreadsheet is read and processed by using <code class="docutils literal notranslate"><span class="pre">read_excel_file</span></code>, - The lat-long information is converted to addresses by using <code class="docutils literal notranslate"><span class="pre">geo_coder</span></code> - A payload is prepared by using <code class="docutils literal notranslate"><span class="pre">create_payload</span></code> - The fugitive emission is requested from the API by using <code class="docutils literal notranslate"><span class="pre">get_fugitive_emission_from_api</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read_excel_file</span><span class="p">(</span><span class="s1">&#39;./refrigeration_leaks_insights.xlsx&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="n">CO2e</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">create_payload</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">CO2e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_fugitive_emission_from_api</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;CO2e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CO2e</span>

<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CO2e&#39;</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;background-color&#39;</span><span class="p">:</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [01:18&lt;00:00,  1.08s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_9ed6b_row0_col16, #T_9ed6b_row1_col16, #T_9ed6b_row2_col16 {
  background-color: lightgreen;
}
</style>
<table id="T_9ed6b">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_9ed6b_level0_col0" class="col_heading level0 col0" >Level 0</th>
      <th id="T_9ed6b_level0_col1" class="col_heading level0 col1" >Level 1</th>
      <th id="T_9ed6b_level0_col2" class="col_heading level0 col2" >Level 2</th>
      <th id="T_9ed6b_level0_col3" class="col_heading level0 col3" >Lat</th>
      <th id="T_9ed6b_level0_col4" class="col_heading level0 col4" >Long</th>
      <th id="T_9ed6b_level0_col5" class="col_heading level0 col5" >Cap</th>
      <th id="T_9ed6b_level0_col6" class="col_heading level0 col6" >GWP</th>
      <th id="T_9ed6b_level0_col7" class="col_heading level0 col7" >Age</th>
      <th id="T_9ed6b_level0_col8" class="col_heading level0 col8" >leak%</th>
      <th id="T_9ed6b_level0_col9" class="col_heading level0 col9" >Start Date (YYYY-MM-DD)</th>
      <th id="T_9ed6b_level0_col10" class="col_heading level0 col10" >End Date (YYYY-MM-DD)</th>
      <th id="T_9ed6b_level0_col11" class="col_heading level0 col11" >Asset id</th>
      <th id="T_9ed6b_level0_col12" class="col_heading level0 col12" >asset_type</th>
      <th id="T_9ed6b_level0_col13" class="col_heading level0 col13" >Type</th>
      <th id="T_9ed6b_level0_col14" class="col_heading level0 col14" >Consumption Quantity</th>
      <th id="T_9ed6b_level0_col15" class="col_heading level0 col15" >Unit</th>
      <th id="T_9ed6b_level0_col16" class="col_heading level0 col16" >CO2e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_9ed6b_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_9ed6b_row0_col0" class="data row0 col0" >name1</td>
      <td id="T_9ed6b_row0_col1" class="data row0 col1" >FOOD STORAGE</td>
      <td id="T_9ed6b_row0_col2" class="data row0 col2" >USA</td>
      <td id="T_9ed6b_row0_col3" class="data row0 col3" >42.93</td>
      <td id="T_9ed6b_row0_col4" class="data row0 col4" >-93.48</td>
      <td id="T_9ed6b_row0_col5" class="data row0 col5" >3900</td>
      <td id="T_9ed6b_row0_col6" class="data row0 col6" >1.27</td>
      <td id="T_9ed6b_row0_col7" class="data row0 col7" >19</td>
      <td id="T_9ed6b_row0_col8" class="data row0 col8" >25.25</td>
      <td id="T_9ed6b_row0_col9" class="data row0 col9" >2024-04-11 00:00:00</td>
      <td id="T_9ed6b_row0_col10" class="data row0 col10" >2025-04-11 00:00:00</td>
      <td id="T_9ed6b_row0_col11" class="data row0 col11" >14201</td>
      <td id="T_9ed6b_row0_col12" class="data row0 col12" >Refrigeration</td>
      <td id="T_9ed6b_row0_col13" class="data row0 col13" >R-448A</td>
      <td id="T_9ed6b_row0_col14" class="data row0 col14" >897.60</td>
      <td id="T_9ed6b_row0_col15" class="data row0 col15" >kg</td>
      <td id="T_9ed6b_row0_col16" class="data row0 col16" >4486654.75</td>
    </tr>
    <tr>
      <th id="T_9ed6b_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_9ed6b_row1_col0" class="data row1 col0" >name1</td>
      <td id="T_9ed6b_row1_col1" class="data row1 col1" >FOOD STORAGE</td>
      <td id="T_9ed6b_row1_col2" class="data row1 col2" >USA</td>
      <td id="T_9ed6b_row1_col3" class="data row1 col3" >33.87</td>
      <td id="T_9ed6b_row1_col4" class="data row1 col4" >-95.23</td>
      <td id="T_9ed6b_row1_col5" class="data row1 col5" >3600</td>
      <td id="T_9ed6b_row1_col6" class="data row1 col6" >0.57</td>
      <td id="T_9ed6b_row1_col7" class="data row1 col7" >5</td>
      <td id="T_9ed6b_row1_col8" class="data row1 col8" >14.18</td>
      <td id="T_9ed6b_row1_col9" class="data row1 col9" >2024-04-12 00:00:00</td>
      <td id="T_9ed6b_row1_col10" class="data row1 col10" >2025-04-12 00:00:00</td>
      <td id="T_9ed6b_row1_col11" class="data row1 col11" >14202</td>
      <td id="T_9ed6b_row1_col12" class="data row1 col12" >Refrigeration</td>
      <td id="T_9ed6b_row1_col13" class="data row1 col13" >R-513A</td>
      <td id="T_9ed6b_row1_col14" class="data row1 col14" >502.20</td>
      <td id="T_9ed6b_row1_col15" class="data row1 col15" >kg</td>
      <td id="T_9ed6b_row1_col16" class="data row1 col16" >2086308.08</td>
    </tr>
    <tr>
      <th id="T_9ed6b_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_9ed6b_row2_col0" class="data row2 col0" >name1</td>
      <td id="T_9ed6b_row2_col1" class="data row2 col1" >FOOD STORAGE</td>
      <td id="T_9ed6b_row2_col2" class="data row2 col2" >USA</td>
      <td id="T_9ed6b_row2_col3" class="data row2 col3" >48.34</td>
      <td id="T_9ed6b_row2_col4" class="data row2 col4" >-95.43</td>
      <td id="T_9ed6b_row2_col5" class="data row2 col5" >3800</td>
      <td id="T_9ed6b_row2_col6" class="data row2 col6" >2.23</td>
      <td id="T_9ed6b_row2_col7" class="data row2 col7" >15</td>
      <td id="T_9ed6b_row2_col8" class="data row2 col8" >22.81</td>
      <td id="T_9ed6b_row2_col9" class="data row2 col9" >2024-04-13 00:00:00</td>
      <td id="T_9ed6b_row2_col10" class="data row2 col10" >2025-04-13 00:00:00</td>
      <td id="T_9ed6b_row2_col11" class="data row2 col11" >14203</td>
      <td id="T_9ed6b_row2_col12" class="data row2 col12" >Refrigeration</td>
      <td id="T_9ed6b_row2_col13" class="data row2 col13" >R-507A</td>
      <td id="T_9ed6b_row2_col14" class="data row2 col14" >825.10</td>
      <td id="T_9ed6b_row2_col15" class="data row2 col15" >kg</td>
      <td id="T_9ed6b_row2_col16" class="data row2 col16" >7838861.50</td>
    </tr>
  </tbody>
</table></div>
</div>
</section>
<section id="Exploratory-Data-Analysis">
<h3>Exploratory Data Analysis<a class="headerlink" href="#Exploratory-Data-Analysis" title="Link to this heading">¶</a></h3>
<p>In this section, we demonstrate how you can use CO2 emissions data to generate valuable insights. We begin by examining scatter plots of CO2 emissions for various relevant parameters. This analysis helps to identify potential relationships between emissions and these parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">## Emissions vs Age</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Emissions vs Age&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>

<span class="c1">## Emissions vs Leak %</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;leak%&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Emissions vs Leak %&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>

<span class="c1">## Emissions vs Consumption Quantity</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Consumption Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Emissions vs Consumption&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#28b463&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: title={&#39;center&#39;: &#39;Emissions vs Consumption&#39;}, xlabel=&#39;Consumption Quantity&#39;, ylabel=&#39;CO2e&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_24_1.png" src="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_24_1.png" />
</div>
</div>
<p>From these scatter plots plots, we can observe a few insights: - A strong correlation between emission and consumption. - A weak or no correlation of emission with Age and Leak%. - Emission vs consumption appears to be made up of different lines.</p>
<p>Another way to look at the data is to use <code class="docutils literal notranslate"><span class="pre">seaborn-pairplot</span></code>. This plot type is widely used in data analysis and provides useful insights across different features by providing a convenient way to look at both correlation and distribution of the available data. We can also apply the best fit line to the scatter plots.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;leak%&quot;</span><span class="p">,</span> <span class="s2">&quot;Consumption Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e&quot;</span><span class="p">]],</span>
             <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span>
             <span class="n">height</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
             <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;line_kws&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">},</span> <span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;#3498db&#39;</span><span class="p">},</span>
             <span class="n">diag_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;#28b463&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;#28b463&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x14f460a10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_26_1.png" src="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_26_1.png" />
</div>
</div>
<p>The sns-pairplot with the best fit line provides a lot more insights: - The positive slope of best fit line shows correlation between leak% and emissions. This insight was not clear from the plain scatter plot. - A small correlation between age and emissions can also be observed. - A high correlation between leak% and consumption is seen. Intuitively, a higher leak value should result in higher consumption. - We can also observe a positive slope in leak% vs age plot which suggests that older
assets might have higher leakage. - The histogram in the diagonal plane of the diagram provides the distribution of different features, for example, most of the assets are approximately 10 years old.</p>
<p>These insights are quite useful when you select features for a model.</p>
<p>In analyzing the data this far, it might be that the type of refrigerant used has an impact on the quantity of emission. Let’s segregate the data by the refrigerant, which is commodity_type, to test this assumption:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## segregate the data by the refrigerant(commodity_type)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;leak%&quot;</span><span class="p">,</span> <span class="s2">&quot;Consumption Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2e&quot;</span><span class="p">]],</span>
             <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span>
             <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">diag_kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">,</span>
             <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x3105d90d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_28_1.png" src="../../../../_images/notebooks_samples_scope1_refrigeration_leaks_insights_refrigeration_leaks_insights_28_1.png" />
</div>
</div>
<p>These plots indicate that the assumption is correct. The type of refrigerant has an impact on the quantity of emission.</p>
<ul class="simple">
<li><p>The refrigerant R-404A, which is indicated in purple, has the highest slope compared to the other types which means the highest emission per unit of refrigerant used.</p></li>
<li><p>Phasing out R-404A units and replacing them with R-513A units, which are indicated in orange, or HFC-132A units, which are indicated in red, can reduce the overall CO2 Emissions of the organization.</p></li>
</ul>
</section>
</section>
<section id="Related-Links">
<h2>Related Links<a class="headerlink" href="#Related-Links" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://developer.ibm.com/apis/catalog/ghgemissions--ibm-envizi-emissions-api/Introduction">Emissions API Developer Guide</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../sustainable_crew_scheduling/carbon_aware_crew_scheduling.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Carbon-aware fleet vehicle selection for crews</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../environmental_impact_of_power_plant/power_plant.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Calculating the Environmental Impact of Power Plants</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, IBM Corporation
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Getting Insights About Refrigeration Leaks</a><ul>
<li><a class="reference internal" href="#Overview">Overview</a></li>
<li><a class="reference internal" href="#Setup">Setup</a><ul>
<li><a class="reference internal" href="#Authorization-Token">Authorization Token</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Utility-Functions">Utility Functions</a></li>
<li><a class="reference internal" href="#Use-Case-Implementation">Use Case Implementation</a><ul>
<li><a class="reference internal" href="#Querying-for-the-refrigeration-use-case">Querying for the refrigeration use case</a></li>
<li><a class="reference internal" href="#Exploratory-Data-Analysis">Exploratory Data Analysis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Related-Links">Related Links</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>